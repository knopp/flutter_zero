# This file is generated. Do not edit directly.
name: Engine Artifacts
on:
  pull_request:
env:
  DEPOT_TOOLS_WIN_TOOLCHAIN: 0
  FLUTTER_PREBUILT_DART_SDK: 1
  R2_BUCKET: flutter-zero-engine
  ENGINE_CHECKOUT_PATH: ${{ github.workspace }}/engine
jobs:
  guard:
    runs-on: ubuntu-latest
    outputs:
      should_run: ${{ steps.check.outputs.should_run }}
    steps:
      - name: Checkout the repository
        uses: actions/checkout@v4
        with:
          path: ''
      - name: Generate engine content hash
        id: engine_content_hash
        run: |
          echo value=6381a0b9ab1f51f91b6c1bd8d35a1ab4b33efca8 >> $GITHUB_OUTPUT
      - name: Check if engine.stamp exists
        id: check
        run: |
          URL="https://engine.flutter0.dev/flutter_infra_release/flutter/${{ steps.engine_content_hash.outputs.value }}/engine_stamp.json"
          if curl --head --silent --fail "$URL" > /dev/null; then
            echo "Engine stamp exists at $URL"
            echo "should_run=false" >> $GITHUB_OUTPUT
          else
            echo "Engine stamp does not exist at $URL"
            echo "should_run=true" >> $GITHUB_OUTPUT
          fi
